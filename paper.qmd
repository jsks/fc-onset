---
title: "Frozen Civil Conflicts"
subtitle: "The Role of External State Support"
author: J.L.A. Krusell
date: "`r Sys.Date()`"
linestretch: 1.25
bibliography: library.bib
format: pdf
execute:
    cache: true
    echo: false
    warning: false
abstract: |
    Frozen conflicts are among some of the most pernicious, difficult to
    resolve conflicts. Surprisingly, little scholarly attention has been
    paid to the factors influencing their emergence. This paper addresses
    one possible dimension, namely the effect of external state support to
    conflict actors on the probability of an ongoing civil conflict
    becoming frozen. I use an original dataset coding frozen conflicts as
    an outcome among UCDP civil conflict episodes from 1975 to 2019 in
    order to construct a series of bayesian, hierarchical probit models
    motivated by an application of bargaining theory to the domain of
    frozen conflicts. Results indicate that directed support to rebels in
    the absence of similar support to the government side increases the
    probability that a civil conflict episode terminates as a frozen
    conflict. All other treatment conditions --- specifically, directed
    support provided only to the government and directed supported given
    to both sides --- are found to be inconsequential. Taken together,
    these findings help provide a more nuanced understanding of conflict
    termination beyond the common assumption that conflicts either
    conclude through a negotiated settlement or a one-sided military
    victory. Furthermore, this paper also helps shed light on the
    conditions under which actors may prefer a sub-optimal solution,
    allowing a conflict to transition into a state of unstable peace with
    an ever present threat of violent re-escalation, rather than a
    conclusive termination.
---

[//]: # Setup R environment
```{r setup, include = F}
library(dplyr)
library(ggplot2)
library(ggthemes)
library(ggdist)
library(knitr)
library(patchwork)
library(tidyr)

# Project specific utility package
library(fc.utils)

options(knitr.kable.NA = ".", knitr.kable.format = "latex",
        knitr.kable.linesep = "")

theme_set(theme_tufte(base_family = "TeX Gyre Pagella", base_size = 10))

design <- readRDS("./data/models/design.rds")
```

# Introduction

**Research question: to what extent does external state support to conflict actors affect the probability that a civil conflict becomes frozen?**


# Empirics

To empirically assess whether external state support for conflict actors affects the probability of a civil conflict episode terminating as a frozen conflict a series of bayesian probit models were run using original data on frozen civil conflicts. A mixed identification strategy was employed by both conditioning on relevant covariates and instrumenting external support with UN roll call votes.

In what follows, I will first present the model specification and results from a probit regression predicting the onset of a frozen conflict. I will then decrease the dependent and independent variables, including operationalizations and data sources.

## Probit Model

I model the onset of frozen civil conflicts using a hierarchical bayesian probit model. The unit of analysis is conflict episodes --- contiguous years of active fighting according  to the UCDP definition of armed conflict as a "contested incompatibility that concerns a government and/or territory where the use of armed forced between two parties, of which at least one is the government of a state, results in at least 25 battle-related deaths within a calendar year" [@gleditsch_armed_2002; @davies_organized_2023]. The outcome, $y_i \in \{0, 1\}$ for $i = 1, 2, \ldots, N$ episodes, is a binary indicator denoting whether a given episode terminates in a frozen state modeled as a function of a matrix of treatment variables, $T$, and a set of additional control covariates, $X$, such that

\begin{align*}
y_i | \pi_i & \sim \text{Bernoulli}(\pi_i) \\
\pi_i & = \Phi\left(\alpha + X_i' \beta + T_i' \delta_{k_i} + \gamma_{c_i}\right)
\end{align*}

where $\Phi(\cdot)$ is the standard normal cumulative density function. Then, $\delta_k$ is the group specific vector of treatment effects. I allow the treatment effects to vary according to whether the underlying incompatibility for the given conflict episode concerns territory or control of the central government in order to account for potential differential effects, thus $\delta \in \mathbb{R}^{D \times K}$ for $D$ treatment variables. Finally, $\gamma_c$ represents a varying intercept for each country in order to capture unmodeled time invariant heterogeneity between countries.

In the case of the global intercept and slope coefficients for the control variables, $X$, I select fairly conservative, weakly informative priors given the restricted sample size and moderate number of predictors. Specifically, I set $\alpha \sim \text{N}(0, 5)$ and $\beta \sim \text{N}(0, 1)$ to improve sampling efficiency by placing less prior probability density on unlikely large values on the probit scale and to provide a degree of regularization.

For $\delta_k$ and $\gamma$ I use hierarchical priors that allow for varying effects while partially pooling information across groups to prevent overfitting. Regarding the latter, this means $\delta_{jk} \sim \text{N}(\mu_j, \tau_j)$ for $j = 1, 2, \ldots, D$ where $\mu_j \sim \text{N}(0, 1)$ and $\tau_j \sim \text{N}(0, 2.5)$. And for the former, $\gamma_c \sim \text{N}(0, \sigma)$ and $\sigma \sim \text{N}(0, 1)$. The particularly restrictive hyperprior on $\sigma$ shrinks the posterior $\gamma$ estimates towards zero and encodes a significant degree of skepticism towards country-specific deviations.[^country-intercepts]

[^country-intercepts]: The risk for overfitting is especially high for the country-specific intercepts since the number of observations per country is relatively small with the median country only experiencing two episodes within the time period under study.

Due to the non-linear nature of a probit regression model, in order to interpret the estimated association between the treatments and outcome, the target empirical estimands are the group-specific average marginal effects, *i.e.* the changes in the conditional expectation of the outcome variable given the various treatment states versus the baseline control averaged over the relevant subgroup sample. Let $\theta$ denote the vector of all unknown parameters in the regression model, then the average marginal effect (AME) for the $j^{th}$ treatment state represented by vector $w_j$ for subsample $k$ can be approximated using $m = 1, 2, \ldots, M$ posterior draws from $\theta$ such that

\begin{align*}
\text{AME}_{jk}^{(m)} = \frac{1}{N_k} \sum_{i \in S_k} P\left(y_i = 1 | T = w_j, X_i, \theta^{(m)}\right) - P\left(y_i = 1 | T = 0_{D}, X_i, \theta^{(m)}\right)
\end{align*}

## Data

### Measuring Frozen Conflicts

The outcome variable in my regression model is a binary indicator for whether a civil conflict terminates in a frozen state. Following the definition of frozen conflicts offered earlier, I construct this measure using a mix of automated and manual coding of intrastate and internationalized intrastate conflict terminations taken from the UCDP Conflict Termination Dataset [@kreutz_how_2010].[^protocol] Episodes were considered terminated if the total number of battle related fatalities dropped below 25 within a year. I subsequently labeled a termination as a frozen conflict if three criteria were satisfied. First, an episode could not result in a one-sided military victory. This would constitute a conclusive termination allowing the victor to set the terms of the post-conflict order. Second, the episode could not conclude with a comprehensive peace agreement that addresses the underlying core issue according to the UCDP Peace Agreement Dataset [@pettersson_organized_2019].[^partial] To account for the possibility of a failed peace agreement I further required that the comprehensive peace agreement had to last for at least one calendar year in order to disqualify an episode termination as a frozen conflict.[^strict_frozen] Finally, an episode could not result in actor death since this is a minimum necessary condition for a conflict to become frozen. For a state actor this meant that although there could be a turnover in the regime, the state could not cease to exist as a sovereign entity following the conclusion of the conflict episode. For non-state actors this entailed a continued existence for at least five years post-conflict without renouncing political violence and/or a re-escalation of violence into a new conflict episode within the same time period. This was done to exclude situations where rebel groups unilaterally renounce violence as a political strategy and either disband or transition into political parties or civil society organizations.

[^protocol]: For a detailed description of the codcing procedure see the protocol document in the supplemental materials.

[^partial]: Note, this does not exclude tha possibility that frozen conflicts can arise following a partial peace agreement or ceasefire. For example, the First Nagorno-Karabkh War was terminated with the 1994 Bishkek Protocol establishing a general ceasefire; however, the agreement failed to address the status of Nagorno-Karabakh leading to a frozen conflict with periodic re-escalations until the forcible reintegration of the territory by Azerbaijan following the 2023 offensive.

[^strict_frozen]: In the appendix I extend the analysis presented in this paper and run a series of robustness checks where I increase the number of years required for a compehensive peace agreement to be in place in order to better distingiush between frozen conflicts and short-term pauses in fighting.


```{r}
dataset <- readRDS("./data/merged_data.rds")
n_frozen <- filter(dataset, frozen == 1) |> nrow()
n_terr_frozen <- filter(dataset, frozen == 1, incompatibility == 1) |> nrow()
```


In total, `r n_frozen` frozen conflicts were identified out of `r nrow(dataset)` civil conflict terminations, comprising approximately `r sprintf("%.0f", 100 * n_frozen / nrow(dataset))` percent of all observations for the period 1975 to 2017. Of the frozen conflicts, `r n_terr_frozen` were conflicts where the central incompatibility between conflict actors concerned territory rather than control of the central government. @fig-frozen shows both a world map of the countries that have experienced at least one frozen conflict within the coded time period as well as the incidence rate of frozen conflicts per year.


```{r}
#| fig-height: 2
#| label: fig-frozen
#| fig-cap: |
#|    On the left, a world map showing the geographic distribution of
#|    countries that have experienced at least one frozen conflict
#|    highlighted in blue. On the right, the incidence rate of new
#|    frozen conflicts per year.

frozen <- filter(dataset, frozen == 1) |>
    mutate(country = sub("Government of ", "", side_a),
           country = case_when(country == "Russia (Soviet Union)" ~ "Russia",
                               country == "United Kingdom" ~ "UK",
                               country == "Congo" ~ "Republic of Congo",
                               country == "Myanmar (Burma)" ~ "Myanmar",
                               country == "Bosnia-Herzegovina" ~ "Bosnia and Herzegovina",
                               country == "Serbia (Yugoslavia)" ~ "Serbia",
                               country == "DR Congo (Zaire)" ~ "Democratic Republic of the Congo",
                               T ~ country))

sub.df <- group_by(frozen, country) |> count(frozen)

world <- map_data("world") |>
    filter(region != "Antarctica") |>
    left_join(sub.df, by = c("region" = "country")) |>
    mutate(n = ifelse(is.na(n), 0, 1) |> as.factor())

p1 <- ggplot(world, aes(long, lat, map_id = region, fill = n, group = group)) +
    geom_map(map = world, color = "grey", size = 0.25) +
    scale_fill_manual(values = c("0" = "#CFCFC4", "1" = "#268bd2"), guide = F) +
    theme(legend.position = "none",
          axis.title.x = element_blank(),
          axis.title.y = element_blank(),
          axis.ticks = element_blank(),
          axis.text = element_blank())

p2 <- filter(dataset, frozen == 1) |>
    ggplot(aes(year)) +
    geom_bar() +
    theme(axis.title.x = element_blank()) +
    ylab("Frozen Onsets")

p1 + p2

```


Compared to the only other extant coding of frozen conflicts, the Frozen Conflict Dataset (FCD) [@klosek_frozen_2021], the measure that I employ features a more expansive operationalization of the concept of frozen conflicts. Although the FCD covers a wider period from 1946 until 2011, only civil conflicts involving *de facto* states according to the coding by @Florea2014 are included resulting in 17 cases of frozen conflict. Furthermore, the termination year for a civil conflict episode in the FCD is coded as the last year in which the number of battle related deaths is above 500. In contrast, my measure looks beyond only *de facto* states and considers civil conflicts where the central incompatibility may center over control of the government. Furthermore, I follow the UCDP and employ a smaller battle related fatalities threshold thereby capturing lower intensity conflict episodes.[^insurgencies]

[^insurgencies]: There is a risk that including low-level conflict episodes risks conflating minor, long-running insurgencies with frozen conflicts. It can be argued that the former may persist at such a low level of activity with only sporadic, isolated incidences of limited violence as to not represent a meaningfully salient issue to the incumbent state and would therefore not constitute a frozen conflict. To mitigate this risk, I also run the analysis presented in this paper on a sub-sample of conflicts with a cumulative intensity of at least 1,000 battle related fatalities since onset.


### Treatments

The primary independent variables in the model are two binary treatment variables measuring whether external support was provided to the government side and whether external support was provided to the rebel side at any time during a civil conflict episode by a third party state actor, as well as the interaction in order to account for a differential effect when both sides receive support. Data on external state support was drawn from the UCDP External Support Dataset [@meier_external_2023] covering the period from 1975 to 2017.

UCDP external support dataset, binary variable for whether an external
state actor offered either fungible or non-fungible support at least
once to either the rebels or government side in a conflict episode.

- Include interaction term, three treatment conditions:

1. No support (control group)
2. Gov. support only
3. Reb. support only
4. Both support

```{r}
conditions <- dataset |>
    mutate(treatment = case_when(ext_sup_s_rebel_bin == 1 & ext_sup_s_state_bin == 1 ~ "Ext. Sup. to Both",
                                 ext_sup_s_rebel_bin == 1 & ext_sup_s_state_bin == 0 ~ "Ext. Sup. Rebel Only",
                                 ext_sup_s_rebel_bin == 0 & ext_sup_s_state_bin == 1 ~ "Ext. Sup. Gov Only",
                                 ext_sup_s_rebel_bin == 0 & ext_sup_s_state_bin == 0 ~ "Ext. Sup. to Neither"))

m <- table(conditions$frozen, conditions$treatment)
rownames(m) <- c("Not Frozen", "Frozen")
knitr::kable(m)
```

### Control Variables

- Episode censored
- Episode Duration log
- Recur
- Cumulative Intensity
- Incompatibility
- Cold War
- Ongoing intra/interstate conflict

Descriptive statistics split between positive and negative outcomes

### Results


The actual model is implemented in Stan, a probabilistic programming language

Using its builtin No-U-Turn sampler run for 2,000 iterations


```{r}
#| fig.cap: Posterior estimates for \delta from a single variate probit model
main_model <- filter(design, outcome == "frozen", treatment == "bin", episodes == "all",
                     censored == "with_censored") |> pull(id)

fit <- sprintf("posteriors/data_%s/fit.rds", main_model) |>  readRDS()

delta <- fit$draws("delta", format = "df") |>
    select(matches("delta")) |>
    pivot_longer(everything(), names_to = "variable")

ll <- extract_digits(delta$variable)
delta$variable <- sprintf("delta[%s]", sapply(ll, `[`, 1))
delta$group <- ifelse(sapply(ll, `[`, 2) == 1, "Government Incompatibility",
                      "Territorial Incompatibility")

ggplot(delta, aes(x = value, y = variable, fill = variable)) +
    stat_halfeye(alpha = 0.8, show.legend = F) +
    geom_vline(xintercept = 0, linetype = "dashed", alpha = 0.2) +
    theme(axis.title.x = element_blank(),
          axis.title.y = element_blank()) +
    scale_y_discrete(labels = c("delta[1]" = "Ext. Sup. to Gov",
                                "delta[2]" = "Ext. Sup. to Rebel",
                                "delta[3]" = "Interaction")) +
    facet_grid(. ~ group) +
    scale_fill_solarized()
```


```{r}
#| fig.cap: Average marginal effects for the three treatment conditions on the predicted probability of a frozen conflict onset.[^ame]
ame <- fit$draws("ame", format = "df") |>
    select(matches("ame")) |>
    pivot_longer(everything(), names_to = "variable")

ll <- extract_digits(ame$variable)
ame$variable <- sprintf("ame[%s]", sapply(ll, `[`, 1))
ame$group <- ifelse(sapply(ll, `[`, 2) == 1, "Government Incompatibility",
                    "Territorial Incompatibility")

ggplot(ame, aes(x = value, y = variable, fill = variable)) +
    stat_eye(alpha = 0.8, show.legend = F) +
    geom_vline(xintercept = 0, linetype = "dashed", alpha = 0.2) +
    theme(axis.title.x = element_blank()) +
    labs(x = parse(text = "bold('AME '*Delta)")) +
    scale_y_discrete(labels = c("ame[1]" = "Ext. Sup. Gov Only",
                                "ame[2]" = "Ext. Sup. Rebel Only",
                                "ame[3]" = "Ext. Sup. to Both")) +
    coord_flip() +
    facet_grid(. ~ group) +
    scale_fill_solarized()
```


# References

::: {#refs}
:::

\newpage

# Appendix

## List of Frozen Conflicts

```{r}

filter(dataset, frozen == 1) |>
    arrange(side_a, year) |>
    select(Government = side_a, `Rebel Group(s)` = side_b, Year = year) |>
    mutate(Government = sub("Government of", "", Government) |> trimws()) |>
    kable(longtable = T)
```

## Simulation Based Calibration

```{R}
sbc <- readRDS("./posteriors/sbc.rds") |>
    select(-.chain, -.iteration, -.draw) |>
    pivot_longer(everything())

ggplot(sbc, aes(x = value)) +
    geom_histogram(bins = 10) +
    facet_wrap(~ name, scales = "free") +
    theme(axis.title.y = element_blank(),
          axis.title.x = element_blank())
```

## Robustness Checks

Different combinations of the following...

- Aggregation of the treatments: binary treatment, binary treatment in the last 5 years of the conflict episode, and proportional treatment. The latter is calculated as the proportion of conflict-years in an episode where one side received external support

- All conflict episodes and only high intensity episodes --- try to distinguish between low-level insurgencies and actual civil wars

- Normal definition for frozen conflicts and a strict definition that requires a duration of at least 2 years in order to exclude temporary one-year pauses in fighting that may be more the result of UCDP's coding decision rather than representing actual frozen conflict.


```{R}
pzero <- function(x) mean(x > 0)

models <- list.dirs("posteriors", recursive = F)
stopifnot(length(models) != 0)

fits <- lapply(models, \(dir) file.path(dir, "fit.rds") |> readRDS())
names(fits) <- basename(models)

model_ames <- lapply(names(fits), function(model) {
    fits[[model]]$summary("ame", pzero, posterior::quantile2, median) |>
                    mutate(id = sub("data_", "", model))
}) |>
    bind_rows() |>
    left_join(design, by = "id")

# Assign the correct variable names/groups
ll <- extract_digits(model_ames$variable)
ame_keys <- sprintf("ame[%s]", sapply(ll, `[`, 1))

model_ames$variable <- case_when(ame_keys == "ame[1]" ~ "Ext. Sup. Gov Only",
                                 ame_keys == "ame[2]" ~ "Ext. Sup. Rebel Only",
                                 ame_keys == "ame[3]" ~ "Ext. Sup. to Both")
model_ames$group <- ifelse(sapply(ll, `[`, 2) == 1, "Government Incompatibility",
                           "Territorial Incompatibility")

ggplot(model_ames, aes(pzero, median)) +
    geom_point(alpha = 0.2) +
    geom_errorbar(aes(ymin = q5, ymax = q95), alpha = 0.25) +
    geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.2) +
    facet_grid(variable ~ group) +
    labs(y = parse(text = "tilde(Delta)"), x = parse(text = "P(tilde(Delta) > 0)")) +
    theme(legend.position = "none")

```
