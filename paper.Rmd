---
title: "Frozen Conflict Onset"
author: J.L.A. Krusell
date: "`r Sys.Date()`"
fontsize: 11pt
linestretch: 1.25
link-citations: true
mainfont: TeX Gyre Pagella
mathfont: TeX Gyre Pagella Math
header-includes:
    - \usepackage[font={small}]{caption}
    - \usepackage{lualatex-math}
output:
    pdf_document:
        dev: cairo_pdf
        keep_tex: true
        latex_engine: lualatex
---

```{r setup, include = F}
library(caTools)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(gridExtra)
library(kableExtra)
library(knitr)
library(stargazer)

options(knitr.kable.NA = ".", knitr.kable.format = "latex",
        knitr.kable.linesep = "")
opts_chunk$set(echo = F, message = F, warning = F)

theme_set(theme_tufte(base_family = "TeX Gyre Pagella", base_size = 10))
```

## Data


To examine the potential correlates of frozen conflict onset, a
dataset at the dyadic - conflict episode level was constructed from
three different sources: the UCDP Conflict Termination Dataset, the
UCDP External Support Dataset (ESD) and the Frozen Conflict Dataset
(FCD) coded by Klosek et al. The first dataset, the UCDP Conflict
Termination dataset, provided conflict-year attributes --- including
duration, type of conflict (interstate vs intrastate), and intensity
level --- for each dyadic relation coded by UCDP from
1949 - 2020. Furthermore, it also codes the episode termination
outcomes in terms of peace agreement, ceasefire agreement, outright
victory, or low activity --- the last of which denotes when a conflict
episode drops below UCDP's threshold of 25 battle related deaths
within a single calendar year.

Data on external support was drawn from UCDP's External Support
Dataset coded from 1975 - 2017 for all intra/interstate
conflicts. This includes an undirected binary measure of whether at
least one actor within a UCDP coded dyad received external support in
a given calendar year, as well as disaggregated dichotomous indicators
for the type of support such as, for example, military support or
direct funding.


Finally, the main dependent variable of interest, the onset of a
frozen conflict, was taken from the Frozen Conflict Dataset which
covers the period from 1946 to 2011. Frozen conflict onset was coded
as the calendar year *after* which initial fighting between two actors
had ceased, which would then be followed by the state of unstable
peace which characterises frozen conflicts.


### Descriptive Statistics

```{R}
df <- readRDS("./data/merged_data.rds")
pos.df <- filter(df, lagged_fc_onset == 1)
```

In total, the final dataset comprises `r nrow(df)` episodes from
`r select(df, side_a, side_b) |> distinct() |> nrow()` unique dyadic
relations with `r nrow(pos.df)` frozen conflict onsets.[^merge] Of
those onsets, `r filter(pos.df, type_of_conflict %in% 3:4) |> nrow()` are
classified as intrastate according to UCDP with
`r filter(pos.df, end_year > 1991) |> nrow()` occurring after the
dissolution of the Soviet Union in 1991.

[^merge]: The FCD dataset lists 42 frozen conflicts in total; however,
    the ESD dataset severely restricts the available time series to
    post-1975. Furthermore, FCD takes a significantly more
    nuanced approach in coding dyadic relations as compared to the
    UCDP. For example, FCD lists separate frozen conflicts between
    Iraq and each coalition partner in the First Gulf War, while UCDP
    only records Iraq - Kuwait as a single conflict dyad.


```{r}
select(pos.df, `Side A` = side_a, `Side B` = side_b, Year = end_year) |>
    arrange(desc(Year)) |>
    kable("latex", booktabs = T, linesep = "",
          caption = "List of Frozen Conflict Onsets") |>
    kable_styling(latex_options = "striped")
```

Compared to the UCDP termination outcomes,
`r filter(pos.df, outcome %in% 1:2) |> nrow()` of the frozen conflict
episodes are coded as having ended with either a ceasefire or peace
agreement and `r filter(pos.df, outcome == 5) |> nrow()` terminated
due to low activity. This leaves `r filter(pos.df, outcome %in% 3:4) |> nrow()`
which concluded with an outright military victory for one
side. Specifically, the Ethiopia - Eritrea (EPLF), Ethiopia - Somalia,
China - N. Vietnam, and Iraq - Kuwait conflicts are all listed as
military victory in the UCDP Termination dataset.

## Analysis

The empirical analysis consists of standard logistic regressions
predicting the onset of a frozen conflict at the dyad-episode
level. More formally, let dependent variable, $y_i \in \{0, 1\}$, be a
binary indicator denoting whether dyad-episode $i$ results in a frozen
conflict. I model the outcome as a bernoulli distributed random
variable, $y_i \sim \text{Bernoulli}(\pi_i)$, where the log-odds of
onset is a linear combination of a set of covariates, $\text{logit}(\pi_i) =
\alpha + X_i' \beta$.

### Results

Figure 1 plots the regression coefficients from separate logistic
regression models predicting frozen conflict onset for each
disaggregated binary indicator of support while controlling for the
maximum intensity level during a conflict episode as well as conflict
type. The only variable with a statistically significant effect is the
indicator for at least one actor receiving funding from an external
actor during a conflict episode.

```{R fig.caption = "Coefficient estimates from separate logistic regression models for each binary indicator of disaggregated support type"}
vars <- c("ext_sup_bin", "ext_x_bin", "ext_w_bin", "ext_m_bin",
          "ext_t_bin", "ext_f_bin", "ext_l_bin")

fits <- lapply(vars, function(v) {
    fml <- sprintf("lagged_fc_onset ~ %s + factor(type_of_conflict) + max_intensity", v) |>
        formula()

    ml <- glm(fml, data = df, family = "binomial")
    ci <- confint(ml)[2,]

    data.frame(var = v, point = coef(ml)[2], lower = ci[1], upper= ci[2])
}) |> bind_rows()

plot.df <- mutate(fits, var = case_when(var == "ext_sup_bin" ~ "Aggregate Support",
                            var == "ext_x_bin" ~ "Military Support",
                                        var == "ext_w_bin" ~ "Weapons",
                                        var == "ext_m_bin" ~ "Material/Logistics",
                                        var == "ext_t_bin" ~ "Training/Expertise",
                                        var == "ext_f_bin" ~ "Funding",
                                        var == "ext_l_bin" ~ "Access to Territory"))

ggplot(plot.df, aes(point, var)) +
    geom_point() +
    geom_errorbarh(aes(xmin = lower, xmax = upper), height = 0) +
    geom_vline(xintercept = 0, linetype = "dotted") +
    xlab("Estimate + 95% CI") +
    theme(axis.title.y = element_blank())
```


Examining only a binary indicator for external support is a crude
measurement for involvement by external actors, especially in cases
where conflict episodes may have a long duration with significant
variation in the amount of support in any given year. Thus, I also run
models using constructed versions of the external funding variable as
a raw count of how many episode years actors received funding from an
external source (`ext_f_count`), an intensity weighted average of
external funding to account for whether external funding during
critical years with the heaviest fighting may be most important
(`ext_f_wavg`), and finally, a discounted weighted average with
external funding weighted by 5-year bins such that latter years
contribute more heavily to the overall score relative to support in
the beginning of a conflict episode (`ext_f_davg`).

The results are shown in table 2. In all cases the constructed
external funding variables are statistically significant and
positively related to the probability of a frozen conflict onset.


```{R results = "asis"}
ml1 <- glm(lagged_fc_onset ~ ext_f_bin, data = df, family = "binomial")

ml2 <- glm(lagged_fc_onset ~ ext_f_bin + factor(type_of_conflict), data = df, family = "binomial")

ml3 <- glm(lagged_fc_onset ~ ext_f_bin + factor(type_of_conflict) +
               max_intensity, data = df, family = "binomial")

ml4 <- glm(lagged_fc_onset ~ ext_f_count + factor(type_of_conflict) +
               max_intensity, data = df, family = "binomial")

ml5 <- glm(lagged_fc_onset ~ ext_f_wavg + factor(type_of_conflict) +
               max_intensity, data = df, family = "binomial")

ml6 <- glm(lagged_fc_onset ~ ext_f_davg + factor(type_of_conflict) +
               max_intensity, data = df, family = "binomial")

stargazer(ml1, ml2, ml3, ml4, ml5, ml6,
          header = F)
```

To get a better understanding of the effect sizes and how external
funding changes the predicted probabilities of frozen conflict onset,
figure 4 plots the receiver operator curve (ROC) for different
predicted probability cutoffs while table 3 lists the confusion matrix
for predicted vs. actual onsets from model 5. This model was able to
correctly classify 4 out of 15 frozen conflicts with the highest
predicted probability being 0.56. In contrast, a model including only
controls with no external support only yields a maximum predicted
probability of 0.41. While the models in table 2 are quite lackluster
in their performance, there is an increase in predictive power through
the inclusion of external funding as a regression covariate.

```{R}
p <- predict(ml5, type = "response")

m <- table(p > 0.5, df$lagged_fc_onset == 1)
rownames(m) <- c("Predicted: No Onset", "Predicted Onset")
colnames(m) <- c("Actual: No Onset", "Actual: Onset")

kable(m, "latex", caption = "Confusion matrix with a 0.5 predicted probability cutoff for model 5")
```

```{R fig.caption = "ROC curve for model 5"}
invisible(colAUC(p, df$lagged_fc_onset, plotROC = T))
```

Finally, it is worth noting that the only frozen conflicts which were
correctly classified were interstate conflicts. The predicted
probabilities for intrastate frozen conflicts were extremely low,
meaning that external funding is potentially a fairly poor predictor
of whether intrastate conflicts become frozen.

```{R}
df$phat <- signif(p, 2)
filter(df, lagged_fc_onset == 1) |>
    arrange(desc(phat)) |>
    select(`Side A` = side_a, `Side B` = side_b, Year = end_year,
           `Prob. of Onset` = phat) |>
    kable("latex", booktabs = T, linesep = "",
          caption = "Predicted Probabilities from Model 5 for each frozen conflict") |>
    kable_styling(latex_options = "striped")
```


## Conclusion

Extremely tentative results point to external funding as a potential
predictor of frozen conflict onset, albeit only in the case of
interstate conflicts. These results are undermined most notably by the
continued lack of additional control variables, especially actor
specific covariates. Ideally, future models would include at a minimum
GDP per capita and level of democracy; however, this would necessitate
splitting interstate and intrastate conflicts into separate
models. Furthermore, there may also be pernicious issues lurking in
regards to time series censoring since none of the datasets align in
coverage.

Finally, although disaggregated data on the types of external support
provides the opportunity for a more nuanced empirical analysis it also
risks devolving into a p-hacking exercise without strong theoretical
reasoning guiding variable selection.

\newpage


## Appendix

```{R results = "asis"}
ml1 <- glm(lagged_fc_onset ~ ext_f_bin, data = df, family = "binomial")

ml2 <- glm(lagged_fc_onset ~ ext_f_bin + factor(type_of_conflict), data = df, family = "binomial")

ml3 <- glm(lagged_fc_onset ~ ext_f_bin + factor(type_of_conflict) +
               intensity_avg, data = df, family = "binomial")

ml4 <- glm(lagged_fc_onset ~ ext_f_count + factor(type_of_conflict) +
               intensity_avg, data = df, family = "binomial")

ml5 <- glm(lagged_fc_onset ~ ext_f_wavg + factor(type_of_conflict) +
               intensity_avg, data = df, family = "binomial")

ml6 <- glm(lagged_fc_onset ~ ext_f_davg + factor(type_of_conflict) +
               intensity_avg, data = df, family = "binomial")

stargazer(ml1, ml2, ml3, ml4, ml5, ml6,
          header = F)
```

```{R results = "asis"}
ml1 <- glm(lagged_fc_onset ~ ext_f_bin, data = df, family = "binomial")

ml2 <- glm(lagged_fc_onset ~ ext_f_bin + duration, data = df, family = "binomial")

ml3 <- glm(lagged_fc_onset ~ ext_f_bin + duration + factor(type_of_conflict),
           data = df, family = "binomial")

ml4 <- glm(lagged_fc_onset ~ ext_f_bin + duration + factor(type_of_conflict) +
               max_intensity, data = df, family = "binomial")

stargazer(ml1, ml2, ml3, ml4, header = F)
```
